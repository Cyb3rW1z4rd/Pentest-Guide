# Techniques

A very effective method of hiding data on a Windows system is also one of the lesser-known ones: Alternate Data Streams \(ADS\). This feature is part of NTFS and has been since the 1990s, but since its introduction it has received little recognition; this makes it both useful for an attacker who is knowledgeable and dangerous for a defender who knows little about it.

Originally, this feature was designed to ensure interoperability with the Macintosh Hierarchical File System \(HFS\), but it has since been used for other purposes. ADS provides the ability to fork or hide file data within existing files without altering the appearance or behavior of a file in any way. In fact, when you use ADS, you can hide a file from all traditional detection techniques as well as dir and Windows Explorer.

In practice, the use of ADS is a major security issue because it is nearly a perfect mechanism for hiding data. Once a piece of data is embedded and hidden using ADS, it can lie in wait until the attacker decides to run it later.

The process of creating an ADS is simple, as an example let’s hide a file named triforce into a file called smoke.doc:

`type triforce.exe > smoke.doc:triforce.exe`

Executing this command hides the fi le triforce.exe behind the fi le smoke.doc. At this point, the fi le is streamed. The next step is to delete the original file that you just hid, triforce.exe.

As an attacker, retrieving the fi le is as simple as this:

`start smoke.doc:triforce.exe`

This command has the effect of opening the hidden file and executing it.

As a defender, this sounds like bad news, because fi les hidden this way are impossible to detect using most means. But by using some advanced methods, they can be detected. Tools that you can use to do this include the following:

* SFind—A forensic tool for finding streamed files
* LNS—Used for finding ADS streamed files
* Tripwire—Used to detect changes in files; by nature can detect ADS

dir /r shows the hiiden file

