# Scanning & Enummeration

## TL;DR <a id="tldr"></a>

### Oneliners

`curl telnet://127.0.0.1:22` - Even when telnet and netcat are not available, curl usually is.

`timeout 1 bash -c ' < /dev/tcp/216.58.207.46/443 && echo Port is open || echo Port is closed' || echo`

`Connection timeout`

Merging a bit. Something like `curl -s 216.58.207.46:443 > /dev/null && echo Port is open || echo Port is closed`

### Host scan

```text
arp-scan --localnet / arp-scan -l or arp-scan --interface=eth0 192.168.0.0/24
```

```text
netdiscover or netdiscover -r 192.168.0.0/24 or netdiscover -i eth0 -r 192.168.0.0/24
```

```text
nmap -sn 192.168.0.0/24 or 192.168.0.0-255 or 192.0.168.0.*
fping -a -g 192.168.0.1/24 2>/dev/null
```

### Port scan

_**step 1**_ - quick nmap scan

`nmap 192.168.0.33`

_**step 2**_ - fast full port scan

`nmap -T4 -Pn -n -p- --min-parallelism 50 to 100 -vv 192.168.0.24 --max-retries 0 or 1`

`Full port scan = nmap -T4 -Pn –p- -v 192.168.0.33 | tee nmap-portscan.txt`

I see too many people using a full nmap scan on release day which takes ages. Often times first blood is claimed by the pros while people still have scans running.

Using masscan, you can scan all TCP and UDP ports in roughly 2-3 minutes.

`masscan -p1-65535,U:1-65535 10.10.10.x --rate=1000 -e tun0`

`-p1-65535,U:1-65535`tells masscan to scan all TCP/UDP ports  
`--rate=1000`scan rate = 1000 packets per second  
`-e tun0`tells masscan to listen on the VPN network interface for responses

Once you have a list of valid ports from masscan, you can feed them to nmap for service enumeration. For example, if masscan finds ports 80, 443 and 3306 open, the nmap command would be:

`nmap -sV -p80,443,3306 10.10.10.x`

That's it! Waaaaaay faster than a regular nmap scan at T5. Just note that you should not go above 1000pps with masscan, as it can miss ports if it is set too high. If you find masscan is missing ports, try lowering your scan rate to 200-300. This generally is caused by a low quality or low speed connection to the VPN.

_**step 3**_ - nmap detailed open port scan

```text
Focused port scan = nmap -T4 -Pn -n -A -v --version-all --osscan-guess -p 21,22,80,334 192.168.0.33

Focused port scan = nmap -T4 -Pn -A  -v --reason –p 80,22,443,2002 -oA nmap-fullscan 10.10.10.5
```

### Banner Grabbing

* `nc-v $ip 25`
* `telnet $ip 25`
* `nc TARGET-IP 80`

## Scanning

When you moved from footprinting, you transitioned into the scanning phase. Scanning is focused on gathering information from a network with the intention of locating active hosts. You identify hosts for the purpose of attack and in order to make security assessments as needed. You can find information about target systems over the Internet by using public IP addresses. In addition to addresses, you also try to gather information about services running on each host.

During this phase, you use techniques such as these:

* Pings
* Ping sweeps
* Port scans
* Tracert

Some of the processes you use unmask or uncover varying levels of detail about ser-vices. You can also use inverse-scanning techniques that allow you to determine which IP addresses from the ranges you uncovered during footprinting do not have a corresponding live host behind them.

## Enumeration![](../../.gitbook/assets/enumeration-mind-map.png)

The last phase before you attempt to gain access to a system is enumeration. Enumeration, as you have observed, is the systematic probing of a target with the goal of obtaining information such as user lists, routing tables, and protocols from the system. Information about shares, users, groups, applications, protocols, and banners can prove useful in getting to know your target. This phase represents a significant shift in the process: It is your first step from being on the outside looking in to being on the inside of the system and gathering data. This information is now carried forward into the attack phase.

The attacker seeks to locate items such as user and group data that let them remain under the radar longer. Enumeration involves making many more active connections with the system than during previous phases; once you reach this phase, the possibility of detection is much higher, because many systems are configured to log all attempts to gain infor-mation. Some of the data you locate may already have been made public by the target, but you may also uncover hidden share information, among other items.

The information gathered during this phase typically includes, but is not limited to, the following:

* Usernames
* Group information
* Passwords
* Hidden shares
* Device information
* Network layout
* Protocol information
* Server data
* Service information

