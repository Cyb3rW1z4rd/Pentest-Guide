# 161/162 UDP - SNMP

## tl;dr

UDP port 161 and 162

```text
snmpwalk -v 2c -c public 10.10.10.20
snmpwalk -c public -v 1 10.0.0.0
```

```text
snmpwalk -v2c -c public 10.10.10.20 1.3.6.1.2.1.4.34.1.3
```

## Info

**Simple Network Management Protocol**\(**SNMP**\) is an [Internet Standard](https://en.wikipedia.org/wiki/Internet_Standard) protocol for collecting and organizing information about managed devices on [IP](https://en.wikipedia.org/wiki/Internet_Protocol) networks and for modifying that information to change device behavior. Devices that typically support SNMP include cable modems, routers, switches, servers, workstations, printers, and more.[\[1\]](https://en.wikipedia.org/wiki/Simple_Network_Management_Protocol#cite_note-ESNMP-1)

SNMP is widely used in [network management](https://en.wikipedia.org/wiki/Network_management) for [network monitoring](https://en.wikipedia.org/wiki/Network_monitoring). SNMP exposes management data in the form of variables on the managed systems organized in a [management information base](https://en.wikipedia.org/wiki/Management_information_base) \(MIB\) which describe the system status and configuration. These variables can then be remotely queried \(and, in some circumstances, manipulated\) by managing applications.

Three significant versions of SNMP have been developed and deployed. SNMPv1 is the original version of the protocol. More recent versions, SNMPv2c and SNMPv3, feature improvements in performance, flexibility and security.

SNMP is a component of the [Internet Protocol Suite](https://en.wikipedia.org/wiki/Internet_Protocol_Suite) as defined by the [Internet Engineering Task Force](https://en.wikipedia.org/wiki/Internet_Engineering_Task_Force) \(IETF\). It consists of a set of [standards](https://en.wikipedia.org/wiki/Technical_standard) for network management, including an [application layer](https://en.wikipedia.org/wiki/Application_layer) protocol, a database [schema](https://en.wikipedia.org/wiki/Logical_schema), and a set of [data objects](https://en.wikipedia.org/wiki/Data_object).[\[2\]](https://en.wikipedia.org/wiki/Simple_Network_Management_Protocol#cite_note-RFC_3411-2)

The following can be extracted through SNMP:

* Network resources such as hosts, routers, and devices
* File shares
* ARP tables
* Routing tables
* Device-specific information
* Traffic statistics

#### Community strings

It's important to know that there are 2 types of community strings; public and private. Public allows for read access and Private allows access to write.

## Tools

* Nmap
* nmap -sU -Pn
* Snscan
* Metasploit - use auxiliary/scanner/snmp/snmp\_enum
* snmpwalk
* snmp-check

### SNMP Enumeration -Simple Network Management Protocol

* Fix SNMP output values so they are human readable

  apt-get install snmp-mibs-downloader download-mibs

  echo "" &gt; /etc/snmp/snmp.conf

* **SNMP Enumeration Commands**
  * snmp-check -c private -w 192.168.100.1
  * snmpwalk -c public -v1 $ip 1\|
  * grep hrSWRunName\|cut -d\_ \_ -f
  * snmpenum -t $ip
  * onesixtyone -c names -i hosts
* SNMPv3 Enumeration

  nmap -sV -p 161 --script=snmp-info $ip/24

* Automate the username enumeration process for SNMPv3:

  apt-get install snmp snmp-mibs-downloader

  wget [https://raw.githubusercontent.com/raesene/TestingScripts/master/snmpv3enum.rb\`](https://raw.githubusercontent.com/raesene/TestingScripts/master/snmpv3enum.rb`)

* SNMP Default Credentials

  /usr/share/metasploit-framework/data/wordlists/snmp\\_default\\_pass.txt

