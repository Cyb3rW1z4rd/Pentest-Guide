# RFI & LFI

Remote [File Inclusion](https://en.wikipedia.org/wiki/File_inclusion_vulnerability) \(RFI\) and Local File Inclusion \(LFI\) are vulnerabilities that are often found in poorly-written web applications. These vulnerabilities occur when a web application allows the user to submit input into files or upload files to the server.

## Local File Inclusion \(LFI\)

Local File inclusion \(LFI\), or simply File Inclusion, refers to an inclusion attack through which an attacker can trick the web application in including files on the web server by exploiting functionality that dynamically includes local files or scripts. The consequence of a successful LFI attack includes Directory Traversal and Information Disclosure as well as Remote Code Execution.

Typically, Local File Inclusion \(LFI\) occurs, when an application gets the path to the file that has to be included as an input without treating it as untrusted input. This would allow a local file to be supplied to the include statement.

Local File Inclusion is very much like [Remote File Inclusion \(RFI\)](https://www.acunetix.com/blog/articles/remote-file-inclusion-rfi/), with the difference that with Local File Inclusion, an attacker can only include local files \(not remote files like in the case of RFI\).

## Identifying LFI Vulnerabilities within Web Applications

LFI vulnerabilities are easy to identify and exploit. Any script that includes a file from a web server is a good candidate for further LFI testing, for example:

```text
/script.php?page=index.html
```

A penetration tester would attempt to exploit this vulnerability by manipulating the file location parameter, such as:

```text
/script.php?page=../../../../../../../../etc/passwd
```

```text
<?php  phpinfo(); ?>
```

`<?php echo system($_GET['cmd']); ?>` phpbash from Arrexel from HackTheBox

