# Infrastructure

### Domain-&gt;DNS-&gt;IP-&gt;IP range-&gt;Vhosts-&gt;Domains

### Whois

[whois.domaintools.com](https://github.com/Cyb3rW1z4rd/Pentest-Guide/tree/b55bf670800fc3b480967d45da179bf1116857c1/2.%20pentest-notes/02.%20Scanning%20&%20Enummeration/whois.domaintools.com) [https://www.robtex.com/dns-lookup/gamma.nl](https://www.robtex.com/dns-lookup/gamma.nl) [Wayback machine](https://archive.org/web)

nmap --script=whois-domain gamma.nl -sn

## DNS, hostnames and IP

**great site with lots of info**

```text
whois - https://who.is/dns/elsfoo.com
host -t ns/soa/mx gamma.nl
```

**Shows all the nameserver records/mail/nameserver**

```text
dig [@nameserverip] gamma.nl -t ANY/MX/NS/CNAME/A/SOA/TXT/AAAA/PTR +nocookie
dig @nameserver chaos version.bind  txt
```

[https://toolbar.netcraft.com/site\_report?url=http://gamma.nl](https://toolbar.netcraft.com/site_report?url=http://gamma.nl)

**very nice tool** `dnsenum [--dnsserver 10.50.96.5] elsfoo.com`

```text
fierce -dns elsfoo.com
dnsrecon [-n 10.50.96.5] -d gamma.nl and dnsrecon -d megacorpone.com -t axfr
dnsspoof â€“f hostsfile -i <interface>

nmap -sU -p53 --script=dns-recursion <nameserver>
nmap --script=dns-brute elsfoo.com

nmap -sS -sU -p53 -n [netblock] - find DNS server in a Netblock
nmap -sV -sT -sU -p 53 --script="dns* and not (brute or broadcast or dos or fuzzer)" 192.168.100.138
```

**zonetransfer** `host -t axfr elsfoo.com ns3.elsfoo.com [host -l megacorpone.com ns1.megacorpone.com]` `dig @nsztm1.digi.ninja zonetransfer.me -t AXFR +nocookie`

**nslookup**

```text
nslookup elsfoo.com
nslookup -query=mx/ns/soa elsfoo.com / nslookup -type=PTR 173.194.113.224

3 commands pulls back IP address of domain
nslookup-> server [ip nameserver] -> set q=mx/ns/cname -> elsfoo.com
```

## Hostname to IP-address \[! scan whole ip range\]

```text
ping -c 1 gamma.nl
host [hostname]
nslookup www.elsfoo.com
dig hostname +nocookie
```

## Virtual hosts on ip address or domain

[https://pentest-tools.com/information-gathering/find-virtual-hosts\#](https://pentest-tools.com/information-gathering/find-virtual-hosts#)

**virtual hosts on bing.com** `www.bing.com ip:83.149.103.57`

**virtual hosts and reverse ip**

```text
theharvester -d vodw.nl -l 100 -b google -p -n -v
http://reverseip.domaintools.com/search/?q=83.149.103.57
nmap --script=http-vhosts
```

## Ip to Netblock/Domain

```text
whois 198.178.124.83
nslookup 194.53.208.72
dig -x 194.53.208.72 or host 194.53.208.72
**for ip in $(seq 155 190);do host 50.7.67.$ip;done |grep -v "not found"**

nmap -sU -p 22 --script=*dns* 192.168.1.200
```

## DNS Tunneling

`cat /etc/resolv.conf`

`PTR = maps IP address to Hostname` `A = Address, maps hostname to IP address` `NS = Nameserver` `SOA = Start of Authority` `CNAME = maps an alias hostname to an A record hostname` `MX= Mail Exchange`

![](../../.gitbook/assets/dns.png)

