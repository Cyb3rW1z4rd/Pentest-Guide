# 80 - HTTP

### TL;DR

```text
# Nmap
nmap --script=http-enum 192.168.0.01

# Dirsearch
python3 /opt/dirsearch/dirsearch.py -u 10.10.10.68 -e php,txt -f -w /usr/share/wordlists/dirb/common.txt -t 10 -r

# Dirb
dirb https://192.168.1.101

# Gobuster - remove relevant responde codes (403 for example)
gobuster -u http://192.168.1.101 -w /usr/share/seclists/Discovery/Web_Content/common.txt -s '200,204,301,302,307,403,500' -e

GET /page.php?course=PTS HTTP/1.1
Host: www.examplesite.com

# Netcat
nc -v myserver.com 80
HEAD / HTTP/1.1
<empty line>
<empty line>

# OpenSSL
openssl myserver.com:443
HEAD / HTTP/1.1
```

[https://en.wikipedia.org/wiki/List\_of\_HTTP\_status\_codes](https://en.wikipedia.org/wiki/List_of_HTTP_status_codes)

### About

There is essentially no way for a user to know which files are found in which directories on a web-server, unless the whole server has directory listing by default. However, if you go directly to the page it will be shown. So what the attacker can do is to brute force hidden files and directories. Just test a bunch of them. There are several tools for doing this. The attack is of course very noisy and will show up fast in the logs.

## Directories

1. Scan for directories
2. Scan for directories within directories with 403 forbidden status
3. Scan for files within hidden directories with file extensions enabled on tools.

Scan for directories and files like admin.php, robot.txt, sitemap.xml etc etc. Use also **OWASP ZAP.**

> Also scan for forbidden directories \(403\) and for files in there. Start a separate scan per forbidden directory.

### Dirb

dirb &lt;url\_base&gt; \[&lt;wordlist\_file\(s\)&gt;\] \[options\]

`dirb http://10.10.10.37`

`dirb http://10.10.10.78 /usr/share/wordlists/dirb/small.txt -X .sh, .php -o dirboutput.txt`

Wordlists are stored in `/usr/share/wordlists` and as a further option in `dirb`. Default the `common.txt` list is used.

`-w` Don't Stop on WARNING messages. WARNING: Directory IS LISTABLE. No need to scan it. \(Use mode '-w' if you want to scan it anyway\)

`-o` &lt;output\_file&gt;

`-X` Amplify search with this extensions like .sh, .pl, .php, .asp, .txt _**note:**_ add a dot before extension

`-x` Amplify search with the extensions in this file e.g. /usr/share/wordlists/dirb/extensions\_common.txt

**With this extensions file,** directories are also being searched because the first entry is a whitespace and the last one a / so the entries from, for example, the common.txt list\(=default\) are searched for directories and for filenames with the extension file entries.

### Gobuster

gobuster -w /usr/share/wordlists/dirb/common.txt -x php,pl,sh,txt -u [http://10.10.10.27](http://10.10.10.27) -s 200,204,301,302,307,403 -t 25 -e

| option | explanation |
| :--- | :--- |
| -x | search for extension  **,separated no spaces eg pl,sh,txt** |
| -w | wordlist |
| -u | url |
| -t | threads |
| **-k** | Skip SSL certificate verification for HTTPS |
| -e | Expanded mode, print full URL's |
| -v | Verbose output \(errors\) |
| -s | Positive status codes \(200,204,301,302,307\) add 403 |

### Dirsearch

`python3 dirsearch.py -u 10.10.10.68 -e php,txt -f -w /usr/share/wordlists/dirb/common.txt -t 10 -r`

`-e` EXTENSIONS, `--extensions=EXTENSIONS` Extension list separated by comma \(Example: php,asp\)

`-f`, `--force-extensions` Force extensions for every wordlist entry \(like in DirBuster\)

`-r`, `--recursive` Bruteforce recursively

`-t` THREADSCOUNT, `--threads=THREADSCOUNT` Number of Threads

`-x` EXCLUDESTATUSCODES, `--exclude-status=EXCLUDESTATUSCODES` Exclude status code, separated by comma \(example: 301, 500\)

### Owasp Zap

Right click site -&gt; Attack -&gt; `Force Browse directory (and children)`. In forced browse settings select `Force Browse files` and then enter the extensions you wish to include like: pl, sh, php, txt

**Test with Shocker\(10.10.10.56\) =/cgi-bin/user.sh and Aragog \(10.10.10.78\)=hosts.php Bashed \(10.10.10.68\)= /dev and /php and /server-status and config.php from HackTheBox**

### Nikto

nikto \[options\] &lt;url or ip&gt; \[output\]

`nikto -host 10.10.10.27 -port 80,1272 -output nikto.txt`

`-host` Url of IP adress

`-port` Ports can be comma seperated

`-output` Output file and format is according extension : txt,csv,htm,xml

### Wfuzz - The web brute forcer

wfuzz \[options\] \[wordlist\] &lt;URL&gt; FUZZ

`wfuzz -c --hc 404 -w /usr/share/wordlists/wfuzz/general/admin-panels.txt http://10.10.10.27/FUZZ`

Wordlists are stored in /usr/share/wordlists/wfuzz/general. Some usefull list are: `admin-panels` `big` `common` `extensions_common`**These list can also be used inside OWASP ZAP**

`-c` Output with colors

`--hc` Hide responses with the specified code e.g. 404 messages

`-w` Wordlist to use

```text
wfuzz -c -w /usr/share/wfuzz/wordlist/general/megabeast.txt $ip:60080/?FUZZ=test  

wfuzz -c --hw 114 -w /usr/share/wfuzz/wordlist/general/megabeast.txt $ip:60080/?page=FUZZ 

wfuzz -c -w /usr/share/wfuzz/wordlist/general/common.txt "$ip:60080/?page=mailer&mail=FUZZ

wfuzz -c -w /usr/share/seclists/Discovery/Web\_Content/common.txt --hc 404 $ip/FUZZ

      Recurse level 3

wfuzz -c -w /usr/share/seclists/Discovery/Web\_Content/common.txt -R 3 --sc 200 $ip/FUZZ
```

### Nmap

`nmap --script=http-wordpress-users` `nmap --script=http-wordpress-enum` and `nmap --script=http-wordpress-brute`

like full command: `map --script=http-wordpress-users 10,10,10,37 -p 80`

* HTTP Enumeration with NMAP

  \`nmap --script=http-enum -p80 -n $ip/24\`

* Nmap Check the server methods

  \`nmap --script http-methods --script-args http-methods.url-path='/test' $ip\`

* Get Options available from web server

  \`curl -vX OPTIONS vm/test\`

Scan for coldfusion web vulnerabilities

```text
\`nmap -v -p 80 --script=http-vuln-cve2010-2861 $ip\`
```

#### `http-enum`

Enumerates directories used by popular web applications and servers.

`nmap -sV --script=http-enum <target>`

#### `http-default-accounts`

Tests for access with default credentials used by a variety of web applications and devices.

```text
nmap -p 80 --script=http-default-accounts host/ip
```

## Hidden files

[https://www.darknet.org.uk/2018/04/snallygaster-scan-for-secret-files-on-http-servers/](https://www.darknet.org.uk/2018/04/snallygaster-scan-for-secret-files-on-http-servers/)

**PUT is rare in Webservers but do still exist in embedded devices and IOT devices**![](../../.gitbook/assets/screen-shot-2018-05-21-at-15.04.06.png)

## Pictures

strings

binwalk

exiftool

